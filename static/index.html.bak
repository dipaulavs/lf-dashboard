<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Im√≥veis</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üè† Dashboard de Im√≥veis</h1>
            <p class="subtitle">Gest√£o de im√≥veis e leads para integra√ß√£o com Innoitune</p>
        </header>

        <!-- TABS -->
        <div class="tabs">
            <button class="tab-button active" data-tab="imoveis">üì¶ Im√≥veis</button>
            <button class="tab-button" data-tab="leads">üë• Leads</button>
        </div>

        <!-- TAB: IM√ìVEIS -->
        <div id="tab-imoveis" class="tab-content active">
            <div class="actions">
                <button id="btnNovoImovel" class="btn btn-primary">+ Novo Im√≥vel</button>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="üîç Buscar im√≥vel...">
                </div>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <span class="stat-label">Total de Im√≥veis</span>
                    <span class="stat-value" id="totalImoveis">0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Dispon√≠veis</span>
                    <span class="stat-value" id="disponiveis">0</span>
                </div>
            </div>

            <div id="tableContainer">
                <table id="imoveisTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>T√≠tulo</th>
                            <th>Tipo</th>
                            <th>Cidade</th>
                            <th>√Årea (m¬≤)</th>
                            <th>Pre√ßo</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="imoveisBody">
                        <tr>
                            <td colspan="8" class="loading">Carregando im√≥veis...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- TAB: LEADS -->
        <div id="tab-leads" class="tab-content">
            <!-- Filtros -->
            <div class="filters-leads">
                <select id="filterScore" class="filter-select">
                    <option value="all">Todos os scores</option>
                    <option value="frio">Leads Frios (0-30) ‚ùÑÔ∏è</option>
                    <option value="morno">Leads Mornos (31-60) üå°Ô∏è</option>
                    <option value="quente">Leads Quentes (61-100) üî•</option>
                </select>

                <select id="filterImovel" class="filter-select">
                    <option value="all">Todos os im√≥veis</option>
                </select>

                <select id="filterAgendamento" class="filter-select">
                    <option value="all">Todos</option>
                    <option value="true">Agendou visita ‚úÖ</option>
                    <option value="false">N√£o agendou ‚ùå</option>
                </select>

                <button id="btnExportarLeads" class="btn btn-secondary">üì• Exportar CSV</button>
            </div>

            <!-- Estat√≠sticas -->
            <div class="stats">
                <div class="stat-card">
                    <span class="stat-label">Total de Leads</span>
                    <span class="stat-value" id="totalLeads">0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Score M√©dio</span>
                    <span class="stat-value" id="scoreMedio">0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Agendamentos</span>
                    <span class="stat-value" id="totalAgendamentos">0</span>
                </div>
            </div>

            <!-- Gr√°ficos -->
            <div class="charts-container">
                <div class="chart-card">
                    <h3>Distribui√ß√£o por Score</h3>
                    <canvas id="chartScore"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Leads por Im√≥vel</h3>
                    <canvas id="chartImoveis"></canvas>
                </div>
            </div>

            <!-- Tabela de Leads -->
            <div id="tableContainer">
                <table id="leadsTable">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>WhatsApp</th>
                            <th>Score</th>
                            <th>Im√≥vel</th>
                            <th>Agendou?</th>
                            <th>Atualizado</th>
                        </tr>
                    </thead>
                    <tbody id="leadsBody">
                        <tr>
                            <td colspan="6" class="loading">Carregando leads...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal para criar/editar im√≥vel -->
    <div id="modalImovel" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Novo Im√≥vel</h2>
                <button class="close" id="btnFecharModal">&times;</button>
            </div>
            <form id="formImovel">
                <div class="form-group">
                    <label for="titulo">T√≠tulo *</label>
                    <input type="text" id="titulo" name="titulo" required placeholder="Ex: Casa 3 quartos Betim">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="tipo">Tipo *</label>
                        <select id="tipo" name="tipo" required>
                            <option value="casa">Casa</option>
                            <option value="apartamento">Apartamento</option>
                            <option value="chacara">Ch√°cara</option>
                            <option value="terreno">Terreno</option>
                            <option value="comercial">Comercial</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="cidade">Cidade *</label>
                        <input type="text" id="cidade" name="cidade" required placeholder="Ex: Betim">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="area_m2">√Årea (m¬≤)</label>
                        <input type="number" id="area_m2" name="area_m2" placeholder="Ex: 150">
                    </div>

                    <div class="form-group">
                        <label for="preco_total_min">Pre√ßo (R$)</label>
                        <input type="number" id="preco_total_min" name="preco_total_min" placeholder="Ex: 200000">
                    </div>
                </div>

                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status" name="status">
                        <option value="disponivel">Dispon√≠vel</option>
                        <option value="reservado">Reservado</option>
                        <option value="vendido">Vendido</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="faq">FAQ / Informa√ß√µes Detalhadas</label>
                    <textarea id="faq" name="faq" rows="8" placeholder="Descri√ß√£o completa do im√≥vel, localiza√ß√£o, caracter√≠sticas, condi√ß√µes de pagamento, etc."></textarea>
                </div>

                <div class="form-group">
                    <label>URLs das Fotos</label>
                    <div id="fotosContainer">
                        <div class="foto-input">
                            <input type="url" class="foto-url" placeholder="https://exemplo.com/foto1.jpg">
                            <button type="button" class="btn-remove-foto" style="display:none;">‚úï</button>
                        </div>
                    </div>
                    <button type="button" id="btnAdicionarFoto" class="btn btn-secondary">+ Adicionar Foto</button>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="video_tour">Link V√≠deo Tour</label>
                        <input type="url" id="video_tour" name="video_tour" placeholder="https://youtube.com/...">
                    </div>

                    <div class="form-group">
                        <label for="planta_baixa">Link Planta Baixa</label>
                        <input type="url" id="planta_baixa" name="planta_baixa" placeholder="https://drive.google.com/...">
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" id="btnCancelar" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/static/app.js"></script>
    <script src="/static/leads.js"></script>
</body>
</html>
